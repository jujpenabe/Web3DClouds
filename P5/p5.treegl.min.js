/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /gh/VisualComputing/p5.treegl@0.10.4/p5.treegl.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var Tree=function(e){const t={LIBRARY:"p5.treegl",VERSION:"0.10.4",HOMEPAGE:"https://github.com/VisualComputing/p5.treegl"};Object.freeze(t);return e??={},Object.assign(e,{INFO:t,NONE:0,X:1,Y:2,Z:4,_X:8,_Y:16,_Z:32,LABELS:64,SOLID:0,DOTS:1,SQUARE:0,CIRCLE:1,PROJECTION:2,NEAR:1,FAR:2,LEFT:4,RIGHT:8,BOTTOM:16,TOP:32,BODY:64,APEX:128,INVISIBLE:0,VISIBLE:1,SEMIVISIBLE:2,WORLD:"WORLD",EYE:"EYE",NDC:"NDC",SCREEN:"SCREEN",MODEL:"MODEL",ORIGIN:[0,0,0],i:[1,0,0],j:[0,1,0],k:[0,0,1],_i:[-1,0,0],_j:[0,-1,0],_k:[0,0,-1],lowp:0,mediump:1,highp:2,pMatrix:1,mMatrix:2,vMatrix:4,mvMatrix:8,pmvMatrix:16,nMatrix:32,eMatrix:64,pvMatrix:128,pvInvMatrix:256,color4:1,texcoords2:2,normal3:4,position2:8,position3:16,position4:32}),e}(Tree||{});window.Tree=Tree,console.log(Tree.INFO),p5.Matrix.prototype.mult3=function(e){if(void 0!==this.mat3)return new p5.Vector(this.mat3[0]*e.x+this.mat3[3]*e.y+this.mat3[6]*e.z,this.mat3[1]*e.x+this.mat3[4]*e.y+this.mat3[7]*e.z,this.mat3[2]*e.x+this.mat3[5]*e.y+this.mat3[8]*e.z);console.error("mult3 only works with mat3")},p5.Matrix.prototype.mult4=function(e){return new p5.Vector(...this._mult4([e.x,e.y,e.z,1]))},p5.Matrix.prototype._mult4=function(e){if(void 0!==this.mat4)return[this.mat4[0]*e[0]+this.mat4[4]*e[1]+this.mat4[8]*e[2]+this.mat4[12]*e[3],this.mat4[1]*e[0]+this.mat4[5]*e[1]+this.mat4[9]*e[2]+this.mat4[13]*e[3],this.mat4[2]*e[0]+this.mat4[6]*e[1]+this.mat4[10]*e[2]+this.mat4[14]*e[3],this.mat4[3]*e[0]+this.mat4[7]*e[1]+this.mat4[11]*e[2]+this.mat4[15]*e[3]];console.error("_mult4 only works with mat4")},p5.prototype.tMatrix=function(e){return e.copy().transpose(e)},p5.prototype.invMatrix=function(e){return e.copy().invert(e)},p5.prototype.axbMatrix=function(e,t){return e.copy().apply(t)},p5.prototype.iMatrix=function(){return new p5.Matrix},p5.prototype.lMatrix=function(...e){return this._renderer.lMatrix(...e)},p5.RendererGL.prototype.lMatrix=function({from:e=new p5.Matrix,to:t=this.eMatrix()}={}){return t.copy().invert(t).apply(e)},p5.prototype.dMatrix=function(...e){return this._renderer.dMatrix(...e)},p5.RendererGL.prototype.dMatrix=function({from:e=new p5.Matrix,to:t=this.eMatrix(),matrix:r=e.copy().invert(e).apply(t)}={}){return new p5.Matrix("mat3",[r.mat4[0],r.mat4[4],r.mat4[8],r.mat4[1],r.mat4[5],r.mat4[9],r.mat4[2],r.mat4[6],r.mat4[10]])},p5.prototype.pMatrix=function(...e){return this._renderer.pMatrix(...e)},p5.RendererGL.prototype.pMatrix=function(){return this.uPMatrix.copy()},p5.prototype.mMatrix=function(...e){return this._renderer.mMatrix(...e)},p5.RendererGL.prototype.mMatrix=function(){return this.uModelMatrix.copy()},p5.prototype.mvMatrix=function(...e){return this._renderer.mvMatrix(...e)},p5.RendererGL.prototype.mvMatrix=function({vMatrix:e=this._curCamera.cameraMatrix,mMatrix:t=this.uModelMatrix}={}){return e.copy().apply(t)},p5.prototype.nMatrix=function(...e){return this._renderer.nMatrix(...e)},p5.RendererGL.prototype.nMatrix=function({vMatrix:e,mMatrix:t,mvMatrix:r=this.mvMatrix({mMatrix:t,vMatrix:e})}={}){return new p5.Matrix("mat3").inverseTranspose(r)},p5.prototype.vMatrix=function(...e){return this._renderer.vMatrix(...e)},p5.RendererGL.prototype.vMatrix=function(){return this._curCamera.vMatrix()},p5.Camera.prototype.vMatrix=function(){return this.cameraMatrix.copy()},p5.prototype.eMatrix=function(...e){return this._renderer.eMatrix(...e)},p5.RendererGL.prototype.eMatrix=function(){return this._curCamera.eMatrix()},p5.Camera.prototype.eMatrix=function(){return this.cameraMatrix.copy().invert(this.cameraMatrix)},p5.prototype.pmvMatrix=function(...e){return this._renderer.pmvMatrix(...e)},p5.RendererGL.prototype.pmvMatrix=function({pMatrix:e=this.uPMatrix,vMatrix:t,mMatrix:r,mvMatrix:i=this.mvMatrix({mMatrix:r,vMatrix:t})}={}){return e.copy().apply(i)},p5.prototype.pvMatrix=function(...e){return this._renderer.pvMatrix(...e)},p5.RendererGL.prototype.pvMatrix=function({pMatrix:e=this.uPMatrix,vMatrix:t=this._curCamera.cameraMatrix}={}){return e.copy().apply(t)},p5.prototype.pvInvMatrix=function(...e){return this._renderer.pvInvMatrix(...e)},p5.RendererGL.prototype.pvInvMatrix=function({pMatrix:e,vMatrix:t,pvMatrix:r}={}){let i=r?r.copy():this.pvMatrix({pMatrix:e,vMatrix:t});return i.invert(i)},p5.prototype.isOrtho=function(...e){return this._renderer.isOrtho(...e)},p5.RendererGL.prototype.isOrtho=function(){return this.uPMatrix.isOrtho()},p5.Matrix.prototype.isOrtho=function(){return 0!=this.mat4[15]},p5.prototype.nPlane=function(...e){return this._renderer.nPlane(...e)},p5.RendererGL.prototype.nPlane=function(){return this.uPMatrix.nPlane()},p5.Matrix.prototype.nPlane=function(){return 0==this.mat4[15]?this.mat4[14]/(this.mat4[10]-1):(1+this.mat4[14])/this.mat4[10]},p5.prototype.fPlane=function(...e){return this._renderer.fPlane(...e)},p5.RendererGL.prototype.fPlane=function(){return this.uPMatrix.fPlane()},p5.Matrix.prototype.fPlane=function(){return 0==this.mat4[15]?this.mat4[14]/(1+this.mat4[10]):(this.mat4[14]-1)/this.mat4[10]},p5.prototype.lPlane=function(...e){return this._renderer.lPlane(...e)},p5.RendererGL.prototype.lPlane=function(){return this.uPMatrix.lPlane()},p5.Matrix.prototype.lPlane=function(){return 1==this.mat4[15]?-(1+this.mat4[12])/this.mat4[0]:this.nPlane()*(this.mat4[8]-1)/this.mat4[0]},p5.prototype.rPlane=function(...e){return this._renderer.rPlane(...e)},p5.RendererGL.prototype.rPlane=function(){return this.uPMatrix.rPlane()},p5.Matrix.prototype.rPlane=function(){return 1==this.mat4[15]?(1-this.mat4[12])/this.mat4[0]:this.nPlane()*(1+this.mat4[8])/this.mat4[0]},p5.prototype.tPlane=function(...e){return this._renderer.tPlane(...e)},p5.RendererGL.prototype.tPlane=function(){return this.uPMatrix.tPlane()},p5.Matrix.prototype.tPlane=function(){return 1==this.mat4[15]?(this.mat4[13]-1)/this.mat4[5]:this.nPlane()*(this.mat4[9]-1)/this.mat4[5]},p5.prototype.bPlane=function(...e){return this._renderer.bPlane(...e)},p5.RendererGL.prototype.bPlane=function(){return this.uPMatrix.bPlane()},p5.Matrix.prototype.bPlane=function(){return 1==this.mat4[15]?(1+this.mat4[13])/this.mat4[5]:this.nPlane()*(1+this.mat4[9])/this.mat4[5]},p5.prototype.fov=function(...e){return this._renderer.fov(...e)},p5.RendererGL.prototype.fov=function(){return this.uPMatrix.fov()},p5.Matrix.prototype.fov=function(){if(0==this.mat4[15])return Math.abs(2*Math.atan(1/this.mat4[5]));console.error("fov only works for a perspective projection")},p5.prototype.hfov=function(...e){return this._renderer.hfov(...e)},p5.RendererGL.prototype.hfov=function(){return this.uPMatrix.hfov()},p5.Matrix.prototype.hfov=function(){if(0==this.mat4[15])return Math.abs(2*Math.atan(1/this.mat4[0]));console.error("hfov only works for a perspective projection")},p5.prototype.beginHUD=function(...e){this._renderer instanceof p5.RendererGL&&this._renderer.beginHUD(...e)},p5.RendererGL.prototype.beginHUD=function(){this.m=this.mMatrix(),this.v=this.vMatrix(),this.p=this.pMatrix(),this._rendererState=this.push();let e=this.drawingContext;e.flush(),e.disable(e.DEPTH_TEST),this.uModelMatrix=new p5.Matrix,this.uViewMatrix=new p5.Matrix;let t=Number.MAX_VALUE;this._curCamera.ortho(0,this.width,-this.height,0,-t,t),this._hud=!0},p5.prototype.endHUD=function(...e){this._renderer instanceof p5.RendererGL&&this._renderer.endHUD(...e)},p5.RendererGL.prototype.endHUD=function(){let e=this.drawingContext;e.flush(),e.enable(e.DEPTH_TEST),this.pop(this._rendererState),this.uPMatrix.set(this.p),this.uModelMatrix.set(this.m),this.uViewMatrix.set(this.v),this._hud=!1},p5.RendererGL.prototype._parseTransformArgs=function(e,...t){let r=e;const i={};return t.forEach((e=>{e instanceof p5.Vector||Array.isArray(e)?r=e:"object"!=typeof e||e instanceof p5.Vector||Array.isArray(e)||Object.assign(i,e)})),{mainArg:r,options:i}},p5.prototype.treeLocation=function(...e){return this._renderer.treeLocation(...e)},p5.RendererGL.prototype.treeLocation=function(...e){return console.warn("treeLocation is deprecated and will be removed definitively once p5.treegl v1 is released. Please use parsePosition instead."),this.parsePosition(...e)},p5.prototype.parsePosition=function(...e){return this._renderer.parsePosition(...e)},p5.RendererGL.prototype.parsePosition=function(...e){const{mainArg:t,options:r}=this._parseTransformArgs(Tree.ORIGIN,...e);return this._position(t,r)},p5.RendererGL.prototype._position=function(e=Tree.ORIGIN,{from:t=Tree.EYE,to:r=Tree.WORLD,pMatrix:i,vMatrix:o,eMatrix:n,pvMatrix:s,pvInvMatrix:a}={}){return Array.isArray(e)&&(e=new p5.Vector(e[0]??0,e[1]??0,e[2]??0)),t==Tree.MODEL&&(t=this.mMatrix({eMatrix:n})),r==Tree.MODEL&&(r=this.mMatrix({eMatrix:n})),t==Tree.WORLD&&r==Tree.SCREEN?this._worldToScreenPosition({point:e,pMatrix:i,vMatrix:o,pvMatrix:s}):t==Tree.SCREEN&&r==Tree.WORLD?this._screenToWorldPosition({point:e,pMatrix:i,vMatrix:o,pvMatrix:s,pvInvMatrix:a}):t==Tree.SCREEN&&r==Tree.NDC?this._screenToNDCPosition(e):t==Tree.NDC&&r==Tree.SCREEN?this._ndcToScreenPosition(e):t==Tree.WORLD&&r==Tree.NDC?this._screenToNDCPosition(this._worldToScreenPosition({point:e,pMatrix:i,vMatrix:o,pvMatrix:s})):t==Tree.NDC&&r==Tree.WORLD?this._screenToWorldPosition({point:this._ndcToScreenPosition(e),pMatrix:i,vMatrix:o,pvMatrix:s,pvInvMatrix:a}):t==Tree.NDC&&(r instanceof p5.Matrix||r==Tree.EYE)?(r==Tree.EYE?o??this.vMatrix():r.copy().invert(r)).mult4(this._screenToWorldPosition({point:this._ndcToScreenPosition(e),pMatrix:i,vMatrix:o,pvMatrix:s,pvInvMatrix:a})):(t instanceof p5.Matrix||t==Tree.EYE)&&r==Tree.NDC?this._screenToNDCPosition(this._worldToScreenPosition({point:(t==Tree.EYE?n??this.eMatrix():t).mult4(e),pMatrix:i,vMatrix:o,pvMatrix:s})):t==Tree.WORLD&&(r instanceof p5.Matrix||r==Tree.EYE)?(r==Tree.EYE?o??this.vMatrix():r.copy().invert(r)).mult4(e):(t instanceof p5.Matrix||t==Tree.EYE)&&r==Tree.WORLD?(t==Tree.EYE?n??this.eMatrix():t).mult4(e):t instanceof p5.Matrix&&r instanceof p5.Matrix?this.lMatrix({from:t,to:r}).mult4(e):t==Tree.SCREEN&&(r instanceof p5.Matrix||r==Tree.EYE)?(r==Tree.EYE?o??this.vMatrix():r.copy().invert(r)).mult4(this._screenToWorldPosition({point:e,pMatrix:i,vMatrix:o,pvMatrix:s,pvInvMatrix:a})):(t instanceof p5.Matrix||t==Tree.EYE)&&r==Tree.SCREEN?this._worldToScreenPosition({point:(t==Tree.EYE?n??this.eMatrix():t).mult4(e),pMatrix:i,vMatrix:o,pvMatrix:s}):t instanceof p5.Matrix&&r==Tree.EYE?(o??this.vMatrix()).mult4(t.mult4(e)):t==Tree.EYE&&r instanceof p5.Matrix?r.copy().invert(r).mult4((n??this.eMatrix()).mult4(e)):(console.error("couldn't parse your parsePosition query!"),e)},p5.RendererGL.prototype._ndcToScreenPosition=function(e){return new p5.Vector(p5.prototype.map(e.x,-1,1,0,this.width),p5.prototype.map(e.y,-1,1,0,this.height),p5.prototype.map(e.z,-1,1,0,1))},p5.RendererGL.prototype._screenToNDCPosition=function(e){return new p5.Vector(p5.prototype.map(e.x,0,this.width,-1,1),p5.prototype.map(e.y,0,this.height,-1,1),p5.prototype.map(e.z,0,1,-1,1))},p5.RendererGL.prototype._worldToScreenPosition=function({point:e=new p5.Vector(0,0,.5),pMatrix:t,vMatrix:r,pvMatrix:i=this.pvMatrix({pMatrix:t,vMatrix:r})}={}){let o=i._mult4([e.x,e.y,e.z,1]);if(0==o[3])return void console.error("World to screen position broken. Check your pvMatrix!");let n=[0,this.height,this.width,-this.height];return o[0]/=o[3],o[1]/=o[3],o[2]/=o[3],o[0]=.5*o[0]+.5,o[1]=.5*o[1]+.5,o[2]=.5*o[2]+.5,o[0]=o[0]*n[2]+n[0],o[1]=o[1]*n[3]+n[1],new p5.Vector(o[0],o[1],o[2])},p5.RendererGL.prototype._screenToWorldPosition=function({point:e=new p5.Vector(this.width/2,this.height/2,.5),pMatrix:t,vMatrix:r,pvMatrix:i,pvInvMatrix:o=this.pvInvMatrix({pMatrix:t,vMatrix:r,pvMatrix:i})}={}){let n=[0,this.height,this.width,-this.height],s=[e.x,e.y,e.z,1];s[0]=(s[0]-n[0])/n[2],s[1]=(s[1]-n[1])/n[3],s[0]=2*s[0]-1,s[1]=2*s[1]-1,s[2]=2*s[2]-1;let a=o._mult4(s);if(0!=a[3])return a[0]/=a[3],a[1]/=a[3],a[2]/=a[3],new p5.Vector(a[0],a[1],a[2]);console.error("Screen to world position broken. Check your pvInvMatrix!")},p5.prototype.treeDisplacement=function(...e){return this._renderer.treeDisplacement(...e)},p5.RendererGL.prototype.treeDisplacement=function(...e){return console.warn("treeDisplacement is deprecated and will be removed definitively once p5.treegl v1 is released. Please use parseDirection instead."),this.parseDirection(...e)},p5.prototype.parseDirection=function(...e){return this._renderer.parseDirection(...e)},p5.RendererGL.prototype.parseDirection=function(...e){const{mainArg:t,options:r}=this._parseTransformArgs(Tree._k,...e);return this._direction(t,r)},p5.RendererGL.prototype._direction=function(e=Tree._k,{from:t=Tree.EYE,to:r=Tree.WORLD,vMatrix:i,eMatrix:o,pMatrix:n}={}){return Array.isArray(e)&&(e=new p5.Vector(e[0]??0,e[1]??0,e[2]??0)),t==Tree.MODEL&&(t=this.mMatrix({eMatrix:o})),r==Tree.MODEL&&(r=this.mMatrix({eMatrix:o})),t==Tree.WORLD&&r==Tree.SCREEN?this._worldToScreenDirection(e,n):t==Tree.SCREEN&&r==Tree.WORLD?this._screenToWorldDirection(e,n):t==Tree.SCREEN&&r==Tree.NDC?this._screenToNDCDirection(e):t==Tree.NDC&&r==Tree.SCREEN?this._ndcToScreenDirection(e):t==Tree.WORLD&&r==Tree.NDC?this._screenToNDCDirection(this._worldToScreenDirection(e,n)):t==Tree.NDC&&r==Tree.WORLD?this._screenToWorldDirection(this._ndcToScreenDirection(e),n):t==Tree.NDC&&r==Tree.EYE?this.dMatrix({matrix:o??this.eMatrix()}).mult3(this._screenToWorldDirection(this._ndcToScreenDirection(e),n)):t==Tree.EYE&&r==Tree.NDC?this._screenToNDCDirection(this._worldToScreenDirection(this.dMatrix({matrix:i??this.vMatrix()}).mult3(e),n)):t==Tree.SCREEN&&r instanceof p5.Matrix?this.dMatrix({matrix:r}).mult3(this._screenToWorldDirection(e,n)):t instanceof p5.Matrix&&r==Tree.SCREEN?this._worldToScreenDirection(this.dMatrix({matrix:t.copy().invert(t)}).mult3(e),n):t instanceof p5.Matrix&&r instanceof p5.Matrix?this.dMatrix({from:t,to:r}).mult3(e):t==Tree.EYE&&r==Tree.WORLD?this.dMatrix({matrix:i??this.vMatrix()}).mult3(e):t==Tree.WORLD&&r==Tree.EYE?this.dMatrix({matrix:o??this.eMatrix()}).mult3(e):t==Tree.EYE&&r==Tree.SCREEN?this._worldToScreenDirection(this.dMatrix({matrix:i??this.vMatrix()}).mult3(e),n):t==Tree.SCREEN&&r==Tree.EYE?this.dMatrix({matrix:o??this.eMatrix()}).mult3(this._screenToWorldDirection(e,n)):t==Tree.EYE&&r instanceof p5.Matrix?this.dMatrix({matrix:(i??this.vMatrix()).apply(r)}).mult3(e):t instanceof p5.Matrix&&r==Tree.EYE?this.dMatrix({matrix:t.copy().invert(t).apply(o??this.eMatrix())}).mult3(e):t==Tree.WORLD&&r instanceof p5.Matrix?this.dMatrix({matrix:r}).mult3(e):t instanceof p5.Matrix&&r==Tree.WORLD?this.dMatrix({matrix:t.copy().invert(t)}).mult3(e):t instanceof p5.Matrix&&r==Tree.NDC?this._screenToNDCDirection(this._worldToScreenDirection(this.dMatrix({matrix:t.copy().invert(t)}).mult3(e),n)):t==Tree.NDC&&r instanceof p5.Matrix?this.dMatrix({matrix:r}).mult3(this._screenToWorldDirection(this._ndcToScreenDirection(e),n)):(console.error("couldn't parse your parseDirection query!"),e)},p5.RendererGL.prototype._worldToScreenDirection=function(e,t=this.uPMatrix){let r=this._direction(e,{from:Tree.WORLD,to:Tree.EYE}),i=r.x,o=r.y,n=0==t.mat4[15];if(n){let e=Math.abs(this._position(new p5.Vector,{from:Tree.WORLD,to:Tree.EYE}).z*Math.tan(this.fov(t)/2));i/=2*e/this.height,o/=2*e/this.height}let s=r.z;return s/=(t.nPlane()-t.fPlane())/(n?Math.tan(this.fov(t)/2):Math.abs(t.rPlane()-t.lPlane())/this.width),new p5.Vector(i,o,s)},p5.RendererGL.prototype._screenToWorldDirection=function(e,t=this.uPMatrix){let r=e.x,i=e.y,o=0==t.mat4[15];if(o){let e=Math.abs(this._position(new p5.Vector,{from:Tree.WORLD,to:Tree.EYE}).z*Math.tan(this.fov(t)/2));r*=2*e/this.height,i*=2*e/this.height}let n=e.z;n*=(t.nPlane()-t.fPlane())/(o?Math.tan(this.fov(t)/2):Math.abs(t.rPlane()-t.lPlane())/this.width);let s=new p5.Vector(r,i,n);return this._direction(s,{from:Tree.EYE,to:Tree.WORLD})},p5.RendererGL.prototype._ndcToScreenDirection=function(e){return new p5.Vector(this.width*e.x/2,this.height*e.y/2,e.z/2)},p5.RendererGL.prototype._screenToNDCDirection=function(e){return new p5.Vector(2*e.x/this.width,2*e.y/this.height,2*e.z)},p5.prototype.parseShader=function(...e){return e.some((e=>"string"==typeof e&&(e.includes("\n")||e.includes("\r"))))?this.makeShader(...e):this.readShader(...e)},p5.prototype._parseArgs=function(...e){let t,r=Tree.NONE;return e.forEach((e=>{"number"==typeof e?r=e:"object"==typeof e&&(t=e)})),{matrices:r,uiConfig:t}},p5.prototype._parseMakeArgs=function(...e){const t=this._parseArgs(...e);let r,i,o;return e.forEach((e=>{"string"==typeof e&&(e.includes("\n")||e.includes("\r"))?e.includes("gl_Position")?r=e:i=e:"string"==typeof e&&(o=e)})),{...t,vertexShader:r,fragmentShader:i,key:o}},p5.prototype.makeShader=function(...e){const{matrices:t,uiConfig:r,key:i,vertexShader:o,fragmentShader:n}=this._parseMakeArgs(...e),s=new p5.Shader;if(s.key=i,s._pMatrix=(t&Tree.pmvMatrix)===Tree.pmvMatrix||(t&Tree.pMatrix)===Tree.pMatrix,this._coupledWith="the fragment shader provided as param in parseShader()",s._fragSrc=n||e[0],o)s._vertSrc=o;else{const e=this._parseFragmentShader(s._fragSrc);s._vertSrc=this.parseVertexShader({version:e.version,precision:e.precision,varyings:e.varyings,matrices:t,_specs:!1}),s._blender=e.blender}return this.parseUniformsUI(s,r),this._coupledWith=void 0,s},p5.prototype._parseReadArgs=function(...e){const t=this._parseArgs(...e);let r,i,o;return e.forEach((e=>{"string"!=typeof e||e.includes("/")||e.includes(".")?"function"==typeof e&&(i?o=e:i=e):r=e})),{...t,key:r,successCallback:i,failureCallback:o}},p5.prototype.readShader=function(...e){const{matrices:t,uiConfig:r,key:i,successCallback:o,failureCallback:n}=this._parseReadArgs(...e),s=new p5.Shader;let a,p,h;s.key=i,s._pMatrix=(t&Tree.pmvMatrix)===Tree.pmvMatrix||(t&Tree.pMatrix)===Tree.pMatrix;const c=()=>{if(s._fragSrc=a,p)s._vertSrc=p;else{const e=this._parseFragmentShader(a);s._vertSrc=this.parseVertexShader({version:e.version,precision:e.precision,varyings:e.varyings,matrices:t,_specs:!1}),s._blender=e.blender}this.parseUniformsUI(s,r),o&&o(s)};return(e=>{let t=e.length;e.forEach((e=>{this.loadStrings(e,(r=>{const i=r.join("\n");(e=>e.includes("gl_Position"))(i)?p=i:(a=i,h=e),0==--t&&(()=>{this._coupledWith=h.split("/").pop(),c()})()}),n)}))})(e.filter((e=>"string"==typeof e&&(e.includes("/")||e.includes("."))))),s},p5.prototype._parseFragmentShader=function(e){const t=e.indexOf("\n"),r=e.substring(0,t).includes("300")?2:1;let i=Tree.highp,o=Tree.NONE;const n=new RegExp(`^(?!\\s*\\/\\/).*?\\s*${2===r?"in":"varying"}\\s+(\\w+)\\s+(\\w+);`,"gm"),s=e.match(/precision\s+(highp|mediump|lowp)\s+float;/);s&&(i=Tree[s[1]]);const a={color4:"vec4",texcoords2:"vec2",normal3:"vec3",position2:"vec2",position3:"vec3",position4:"vec4"};let p;for(;null!==(p=n.exec(e));){const e=p[1],t=p[2];if(a[t]!==e)throw new Error(`Unsupported or incorrectly named varying found: ${t} of type ${e}`);o|=Tree[t]}return{version:r,precision:i,varyings:o,blender:null!=e.match(/^\s*uniform\s+sampler2D\s+blender\s*;.*?(\/\/.*)?$/gm)}},p5.prototype.parseVertexShader=function({precision:e=Tree.highp,matrices:t=Tree.NONE,varyings:r=Tree.NONE,version:i=2,_specs:o=!0}={}){const n=`\n/*\n${this._coupledWith?"Vertex shader code to be coupled with "+this._coupledWith:""} \nGenerated with treegl version ${Tree.INFO.VERSION}\n${o?"\nFeel free to copy, paste, edit and save it.\nRefer to createShader (https://p5js.org/reference/#/p5/createShader),\nloadShader (https://p5js.org/reference/#/p5/loadShader) and\nand parseShader (https://github.com/VisualComputing/p5.treegl#handling),\nfor details.":""}\n*/`,s=i.toString().includes("2")?"in":"attribute",a=i.toString().includes("2")?"out":"varying",p=0!=(r&Tree.color4),h=0!=(r&Tree.texcoords2),c=0!=(r&Tree.normal3),l=0!=(r&Tree.position2),u=0!=(r&Tree.position3),f=0!=(r&Tree.position4),d=0!=(t&Tree.vMatrix),x=0!=(t&Tree.mMatrix),m=0!=(t&Tree.pmvMatrix),M=0!=(t&Tree.pMatrix),y=0!=(t&Tree.mvMatrix)||f,v=0!=(t&Tree.nMatrix)||c,T=`gl_Position =${m?" uModelViewProjectionMatrix * ":M&&y?" uProjectionMatrix * uModelViewMatrix * ":M&&d&&x?" uProjectionMatrix * uViewMatrix * uModelMatrix * ":M&&d?" uProjectionMatrix * uViewMatrix * ":M&&x?" uProjectionMatrix * uModelMatrix * ":y?" uModelViewMatrix * ":d&&x?" uViewMatrix * uModelMatrix * ":M?" uProjectionMatrix * ":d?" uViewMatrix * ":x?" uModelMatrix * ":" "}aPosition`,_=`\nprecision ${e===Tree.highp?"highp":e===Tree.mediump?"mediump":"lowp"} float;\n${s} vec4 aPosition;\n${p?`${s} vec4 aVertexColor;`:""}\n${h?`${s} vec2 aTexCoord;`:""}\n${c?`${s} vec3 aNormal;`:""}\n${d?"uniform mat4 uViewMatrix;":""}\n${x?"uniform mat4 uModelMatrix;":""}\n${M?"uniform mat4 uProjectionMatrix;":""}\n${v?"uniform mat3 uNormalMatrix;":""}\n${y?"uniform mat4 uModelViewMatrix;":""}\n${m?"uniform mat4 uModelViewProjectionMatrix;":""}\n${p?`${a} vec4 color4;`:""}\n${h?`${a} vec2 texcoords2;`:""}\n${c?`${a} vec3 normal3;`:""}\n${l?`${a} vec2 position2;`:""}\n${u?`${a} vec3 position3;`:""}\n${f?`${a} vec4 position4;`:""}\nvoid main() {\n  ${p?"color4 = aVertexColor;":""}\n  ${h?"texcoords2 = aTexCoord;":""}\n  ${c?"normal3 = normalize(uNormalMatrix * aNormal);":""}\n  ${l?"position2 = aPosition.xy;":""}\n  ${u?"position3 = aPosition.xyz;":""}\n  ${f?"position4 = uModelViewMatrix * aPosition;":""}\n  ${T};\n}`;let E=i.toString().includes("2")?"#version 300 es\n"+n+_:n+_;return E=E.split(/\r?\n/).filter((e=>""!==e.trim())).join("\n"),console.log(E),E},p5.prototype.parseUniformsUI=function(...e){let t,r={};e.forEach((e=>{e instanceof p5.Shader?t=e:"object"==typeof e&&(r=e)}));const{x:i=0,y:o=0,offset:n=0,width:s=120,color:a}=r;return t.uniformsUI&&(console.log("Overwriting uniformsUI for this shader."),this.hideUniformsUI(t)),t.uniformsUI={},t.uniformsUI=this._parseUniformsUI(t._vertSrc,t.uniformsUI),t.uniformsUI=this._parseUniformsUI(t._fragSrc,t.uniformsUI),this.configUniformsUI(t,{x:i,y:o,offset:n,width:s,color:a}),t.uniformsUI},p5.prototype._parseUniformsUI=function(e,t){const r=e.split("\n"),i=(e,t)=>{const[r,i,o=r,n=(t?.1:1)]=e;return this.createSlider(r,i,o,n).hide()};return r.forEach((e=>{if(""===e.trim()||e.trim().startsWith("//"))return;const r=e.match(/uniform\s+(\w+)\s+(\w+);\s*\/\/\s*(.*)/);if(!r)return;const[o,n,s,a]=r;if("vec4"===n){const e=a.trim().replace(/['"]/g,"").split(/\s+/)[0];e?/^[a-zA-Z]+$/.test(e)?(t[s]=this.createColorPicker(e).hide(),console.log(`Created color picker for '${s}' with color: ${e}`)):console.debug(`Failed to create color picker for '${s}': Unsupported color format '${e}'.`):(t[s]=this.createColorPicker("white").hide(),console.log(`Created default color picker for '${s}' with white color.`))}else if("float"===n||"int"===n){const e=a.split(",").map((e=>parseFloat(e.trim())));e.length>=2?(t[s]=i(e,"float"===n),console.log(`Created slider for '${s}' with params: ${e.join(", ")}`)):console.debug(`Failed to parse slider for '${s}': Expected format 'min, max, [value], [step]' but got '${a}'`)}else if("bool"===n){const e=a.trim().toLowerCase().replace(/['"]/g,"").split(/\s+/),r=e.length>0&&!["0","false","null","undefined",""].includes(e[0]),i=this.createCheckbox(s,r).hide();console.log(`Created checkbox for '${s}' with default value: ${r}`),t[s]=i}})),t},p5.prototype.configUniformsUI=function(...e){let t,r={};e.forEach((e=>{e instanceof p5.Shader?t=e:"object"==typeof e&&(r=e)}));let{x:i=0,y:o=0,offset:n=0,width:s=120,color:a}=r;const p=35,h=30,c=40;for(const e in t.uniformsUI){const r=t.uniformsUI[e];if(r instanceof p5.Element){const e=r.elt.type||("div"===r.elt.tagName.toLowerCase()?r.elt.getElementsByTagName("input")[0].type:void 0),t="range"===e?p:"checkbox"===e?h:"color"===e?c:0;"range"===e&&r.style("width",`${s}px`),r.position(i,o),o+=t+n,a&&(r.elt.style.color=a)}}},p5.prototype.resetUniformsUI=function(e){this.hideUniformsUI(e),e.uniformsUI=void 0},p5.prototype.hideUniformsUI=function(e){if(e.uniformsUI)for(const t in e.uniformsUI){const r=e.uniformsUI[t];r.hide(),r.eventListener&&(r.elt.removeEventListener("input",r.eventListener),r.eventListener=void 0)}else console.log("No uniformsUI found for this shader. Call parseUniformsUI(shader) first")},p5.prototype.showUniformsUI=function(e){if(e.uniformsUI)for(const t in e.uniformsUI){const r=e.uniformsUI[t];r.show(),r.eventListener=()=>{e._setUniformUI(t,r)},r.elt.addEventListener("input",r.eventListener),e._setUniformUI(t,r)}else console.log("No uniformsUI found for this shader. Call parseUniformsUI(shader) first")},p5.prototype.setUniformsUI=function(e){for(const t in e.uniformsUI)e._setUniformUI(t,e.uniformsUI[t])},p5.Shader.prototype.setUniformsUI=function(){for(const e in this.uniformsUI)this._setUniformUI(e,this.uniformsUI[e])},p5.Shader.prototype._setUniformUI=function(e,t){const r=t.elt.type||("div"===t.elt.tagName.toLowerCase()?t.elt.getElementsByTagName("input")[0].type:void 0);if("color"===r){const r=t.color();this.setUniform(e,[p5.prototype.red(r)/255,p5.prototype.green(r)/255,p5.prototype.blue(r)/255,p5.prototype.alpha(r)/255])}else"range"===r?this.setUniform(e,t.value()):"checkbox"===r?this.setUniform(e,t.checked()):console.debug("Unsupported element type in found in _setUniformUI")},p5.prototype.applyShader=function(...e){let t,r={};e.forEach((e=>{e instanceof p5.Shader?t=e:"object"==typeof e&&(r=e)}));const{target:i,uniforms:o={},scene:n,options:s={}}=r;i instanceof p5.Framebuffer&&i.begin();const a=i instanceof p5.Graphics?i:this;a===this?a.push():a._rendererState=a.push(),a.shader(t),t.setUniformsUI();for(const e in o)t.setUniform(e,o[e]);return i&&(s.target=i),"function"==typeof n?n(s):(t._pMatrix&&this.beginHUD(),a.overlay(s.flip),t._pMatrix&&this.endHUD()),a===this?a.pop():a.pop(a._rendererState),i instanceof p5.Framebuffer&&i.end(),i||a},p5.prototype.applyEffects=function(...e){let t,r,i={},o=!0;if(e.forEach((e=>{e instanceof p5.Framebuffer||e instanceof p5.Graphics||e instanceof p5.Image||e instanceof p5.MediaElement&&e.elt instanceof HTMLVideoElement?t=e:Array.isArray(e)&&e.every((e=>e instanceof p5.Shader))?r=e:"object"!=typeof e||Array.isArray(e)?"boolean"==typeof e&&(o=e):i=e})),!(t instanceof p5.Framebuffer||t instanceof p5.Graphics||t instanceof p5.Image||t instanceof p5.MediaElement&&t.elt instanceof HTMLVideoElement))return console.log("The source param should be either a p5.Framebuffer, p5.Graphics, p5.Image, or p5.MediaElement (video) in applyEffects(source, effects)."),t;if(!Array.isArray(r))return console.log("The effects param should be an array in applyEffects(source, effects)."),t;let n=t;const s=new Set;return r.forEach(((e,t)=>{if(!(e instanceof p5.Shader))return void console.log(`Skipping effect '${t}' due to missed shader type.`);if(s.has(e))return void console.log(`Skipping duplicated effect '${t}'.`);s.add(e),e.blender instanceof p5.Framebuffer||(e.blender=this.createFramebuffer(),console.log(`New frame buffer blender property set for ${e.key?`shader '${e.key}'`:`effects[${t}] shader`}.`));let r={};e.key?(r=i[e.key]||{},delete e._uniformsWarn):e._uniformsWarn||(console.log(`Set effects[${t}].key to emit custom uniforms for effects[${t}] shader.`),e._uniformsWarn=!0),!e._blender&&console.log(`Skipping effect '${t}' due to '${e.key}' shader missed uniform sampler2D blender variable.`),r.blender=n,n=this.applyShader(e,{target:e.blender,scene:()=>this.overlay(o),uniforms:r})})),n},p5.prototype.createBlender=function(...e){let t,r={};e.forEach((e=>{Array.isArray(e)?t=e:"object"==typeof e&&(r=e)})),Array.isArray(t)&&0!==t.length?t.forEach(((e,t)=>{e instanceof p5.Shader?(e.blender=this.createFramebuffer(r),console.log(`New frame buffer blender property set for ${e.key?`shader '${e.key}'`:`effects[${t}] shader`}.`)):console.log(`Skipping blender creation for effect at index ${t} due to missing shader type.`)})):console.log("Incorrect or missing effects array in createBlender(effects, options). Nothing done")},p5.prototype.removeBlender=function(e){Array.isArray(e)?e.forEach(((e,t)=>{e instanceof p5.Shader?(e.blender?.remove(),e.blender=void 0,console.log(`Blender property removed for ${e.key?`shader '${e.key}'`:`effects[${t}] shader`}.`)):console.log(`Skipping blender removal for effect at index ${t} due to missing shader type.`)})):console.log("Incorrect params in removeBlender(effects). Nothing done")},p5.prototype.texOffset=function(e){return[1/e.width,1/e.height]},p5.prototype.mousePosition=function(e=!0){return[this.pixelDensity()*this.mouseX,this.pixelDensity()*(e?this.height-this.mouseY:this.mouseY)]},p5.prototype.pointerPosition=function(...e){return this._renderer.pointerPosition(...e)},p5.RendererGL.prototype.pointerPosition=function(...e){let t,r,i=!0;return e.forEach((e=>"number"==typeof e?void 0===t?t=e:r=e:"boolean"==typeof e&&(i=e))),[this.pixelDensity()*t,this.pixelDensity()*(i?this.height-r:r)]},p5.prototype.resolution=function(...e){return this._renderer.resolution(...e)},p5.RendererGL.prototype.resolution=function(){return[this.pixelDensity()*this.width,this.pixelDensity()*this.height]},p5.prototype.pixelRatio=function(...e){return this._renderer.pixelRatio(...e)},p5.RendererGL.prototype.pixelRatio=function(e){return this.isOrtho()?Math.abs(this.tPlane()-this.bPlane())/this.height:2*Math.abs(this._position(e,{from:Tree.WORLD,to:Tree.EYE,vMatrix:this._curCamera.cameraMatrix}).z)*Math.tan(this.fov()/2)/this.height},p5.prototype.visibility=function(...e){return this._renderer.visibility(...e)},p5.RendererGL.prototype.visibility=function({corner1:e,corner2:t,center:r,radius:i,bounds:o=this.bounds()}={}){return r?i?this._ballVisibility(r,i,o):this._pointVisibility(r,o):e&&t?this._boxVisibility(e,t,o):console.error("couldn't parse your visibility query!")},p5.RendererGL.prototype._pointVisibility=function(e,t=this.bounds()){for(const r in t){let i=this.distanceToBound(e,r,t);if(i>0)return Tree.INVISIBLE;if(0===i)return Tree.SEMIVISIBLE}return Tree.VISIBLE},p5.RendererGL.prototype._ballVisibility=function(e,t,r=this.bounds()){let i=!0;for(const o in r){let n=this.distanceToBound(e,o,r);if(n>t)return Tree.INVISIBLE;(n>0||-n<t)&&(i=!1)}return i?Tree.VISIBLE:Tree.SEMIVISIBLE},p5.RendererGL.prototype._boxVisibility=function(e,t,r=this.bounds()){Array.isArray(e)&&(e=new p5.Vector(e[0]??0,e[1]??0,e[2]??0)),Array.isArray(t)&&(t=new p5.Vector(t[0]??0,t[1]??0,t[2]??0));let i=!0;for(const o in r){let n=!0;for(let s=0;s<8;++s){let a=new p5.Vector(0!=(4&s)?e.x:t.x,0!=(2&s)?e.y:t.y,0!=(1&s)?e.z:t.z);this.distanceToBound(a,o,r)>0?i=!1:n=!1}if(n)return Tree.INVISIBLE}return i?Tree.VISIBLE:Tree.SEMIVISIBLE},p5.prototype.bounds=function(...e){return this._renderer.bounds(...e)},p5.RendererGL.prototype.bounds=function({vMatrix:e,eMatrix:t}={}){const r=this.nPlane(),i=this.fPlane(),o=this.lPlane(),n=this.rPlane(),s=this.bPlane(),a=this.tPlane();let p=Array(6),h=Array(6);const c=this._position([0,0,0],{from:Tree.EYE,to:Tree.WORLD,eMatrix:t}),l=this._direction([0,0,-1],{from:Tree.EYE,to:Tree.WORLD,vMatrix:e}),u=this._direction([0,1,0],{from:Tree.EYE,to:Tree.WORLD,vMatrix:e}),f=this._direction([1,0,0],{from:Tree.EYE,to:Tree.WORLD,vMatrix:e}),d=p5.Vector.dot(c,l);if(this.isOrtho())p[0]=p5.Vector.mult(f,-1),p[1]=f,p[4]=u,p[5]=p5.Vector.mult(u,-1),h[0]=p5.Vector.dot(p5.Vector.sub(c,p5.Vector.mult(f,-o)),p[0]),h[1]=p5.Vector.dot(p5.Vector.add(c,p5.Vector.mult(f,n)),p[1]),h[4]=p5.Vector.dot(p5.Vector.add(c,p5.Vector.mult(u,-s)),p[4]),h[5]=p5.Vector.dot(p5.Vector.sub(c,p5.Vector.mult(u,a)),p[5]);else{const e=Math.atan2(n,r),t=Math.sin(e),i=Math.cos(e),x=Math.atan2(o,r),m=Math.sin(x),M=Math.cos(x);p[0]=p5.Vector.add(p5.Vector.mult(l,m),p5.Vector.mult(f,-M)),p[1]=p5.Vector.add(p5.Vector.mult(l,-t),p5.Vector.mult(f,i));const y=Math.atan2(a,r),v=Math.sin(y),T=Math.cos(y),_=Math.atan2(s,r),E=Math.sin(_),g=Math.cos(_);p[4]=p5.Vector.add(p5.Vector.mult(l,-v),p5.Vector.mult(u,T)),p[5]=p5.Vector.add(p5.Vector.mult(l,E),p5.Vector.mult(u,-g)),h[0]=m*d-M*p5.Vector.dot(c,f),h[1]=-t*d+i*p5.Vector.dot(c,f),h[4]=-v*d+T*p5.Vector.dot(c,u),h[5]=E*d-g*p5.Vector.dot(c,u)}p[2]=p5.Vector.mult(l,-1),p[3]=l,h[2]=-d-r,h[3]=d+i;let x={};return x[Tree.LEFT]={a:p[0].x,b:p[0].y,c:p[0].z,d:h[0]},x[Tree.RIGHT]={a:p[1].x,b:p[1].y,c:p[1].z,d:h[1]},x[Tree.NEAR]={a:p[2].x,b:p[2].y,c:p[2].z,d:h[2]},x[Tree.FAR]={a:p[3].x,b:p[3].y,c:p[3].z,d:h[3]},x[Tree.TOP]={a:p[4].x,b:p[4].y,c:p[4].z,d:h[4]},x[Tree.BOTTOM]={a:p[5].x,b:p[5].y,c:p[5].z,d:h[5]},x},p5.prototype.distanceToBound=function(...e){return this._renderer.distanceToBound(...e)},p5.RendererGL.prototype.distanceToBound=function(...e){let t,r,i=this.bounds();return e.forEach((e=>{e instanceof p5.Vector?t=e:Array.isArray(e)?t=new p5.Vector(e[0]??0,e[1]??0,e[2]??0):"string"==typeof e||"number"==typeof e?r=e:"object"!=typeof e||null===e||Array.isArray(e)||(i=e)})),p5.Vector.dot(t,new p5.Vector(i[r].a,i[r].b,i[r].c))-i[r].d},p5.prototype.mousePicking=function({mMatrix:e=this.mMatrix(),x:t,y:r,size:i=50,shape:o=Tree.CIRCLE,eMatrix:n,pMatrix:s,vMatrix:a,pvMatrix:p}={}){return this.pointerPicking(this.mouseX,this.mouseY,{mMatrix:e,x:t,y:r,size:i,shape:o,eMatrix:n,pMatrix:s,vMatrix:a,pvMatrix:p})},p5.prototype.pointerPicking=function(...e){return this._renderer.pointerPicking(...e)},p5.RendererGL.prototype.pointerPicking=function(...e){let t,r,i={};e.forEach((e=>{"number"==typeof e?void 0===t?t=e:r=e:"object"==typeof e&&(i=e)}));let{mMatrix:o=this.mMatrix(),x:n,y:s,size:a=50,shape:p=Tree.CIRCLE,eMatrix:h,pMatrix:c,vMatrix:l,pvMatrix:u}=i;if(!n||!s){let e=this.parsePosition({from:o,to:Tree.SCREEN,pMatrix:c,vMatrix:l,pvMatrix:u});n=e.x,s=e.y,a/=this.pixelRatio(this.parsePosition({from:o,to:Tree.WORLD,eMatrix:h}))}let f=a/2;return p===Tree.CIRCLE?Math.sqrt(Math.pow(n-t,2)+Math.pow(s-r,2))<f:Math.abs(t-n)<f&&Math.abs(r-s)<f},p5.prototype.overlay=function(e=!this._renderer._hud){this._renderer._hud?this.quad(0,e?this.height:0,this.width,e?this.height:0,this.width,e?0:this.height,0,e?0:this.height):this.quad(-1,e?1:-1,1,e?1:-1,1,e?-1:1,-1,e?-1:1)},p5.prototype.axes=function(...e){this._renderer.axes(...e)},p5.prototype.parseGeometry=function(e,...t){return this._renderer.parseGeometry(e,...t)},p5.RendererGL.prototype.parseGeometry=function(e,...t){this.beginGeometry(),e(...t);const r=this.endGeometry();return t.find((e=>Array.isArray(e)))||t.find((e=>"object"==typeof e&&null!==e&&Array.isArray(e.colors)))?.colors||r.clearColors(),r.computeNormals(),r},p5.RendererGL.prototype.axes=function({size:e=100,colors:t=["Red","Lime","DodgerBlue"],bits:r=Tree.LABELS|Tree.X|Tree.Y|Tree.Z}={}){if(this._rendererState=this.push(),0!=(r&Tree.LABELS)){const r=e/40,i=e/30,o=1.04*e;this.stroke(t[0%t.length]),this.line(o,r,-i,o,-r,i),this.line(o,-r,-i,o,r,i),this.stroke(t[1%t.length]),this.line(r,o,i,0,o,0),this.line(0,o,0,-r,o,i),this.line(-r,o,i,0,o,0),this.line(0,o,0,0,o,-i),this.stroke(t[2%t.length]),this.line(-r,-i,o,r,-i,o),this.line(r,-i,o,-r,i,o),this.line(-r,i,o,r,i,o)}this.stroke(t[0%t.length]),0!=(r&Tree.X)&&this.line(0,0,0,e,0,0),0!=(r&Tree._X)&&this.line(0,0,0,-e,0,0),this.stroke(t[1%t.length]),0!=(r&Tree.Y)&&this.line(0,0,0,0,e,0),0!=(r&Tree._Y)&&this.line(0,0,0,0,-e,0),this.stroke(t[2%t.length]),0!=(r&Tree.Z)&&this.line(0,0,0,0,0,e),0!=(r&Tree._Z)&&this.line(0,0,0,0,0,-e),this.pop(this._rendererState)},p5.prototype.grid=function(...e){this._renderer.grid(...e)},p5.RendererGL.prototype.grid=function({size:e=100,subdivisions:t=10,style:r=Tree.DOTS}={}){if(this._rendererState=this.push(),r===Tree.DOTS){let r=this.curStrokeWeight,i=0,o=0;this.strokeWeight(2*r),this.beginShape(p5.prototype.POINTS);for(let r=0;r<=t;++r){i=e*(2*r/t-1);for(let r=0;r<=t;++r)o=e*(2*r/t-1),this.vertex(i,o,0)}this.endShape();const n=5,s=t*n;this.strokeWeight(r),this.beginShape(p5.prototype.POINTS);for(let t=0;t<=s;++t){i=e*(2*t/s-1);for(let r=0;r<=s;++r)o=e*(2*r/s-1),t%n==0&&r%n==0||this.vertex(i,o,0)}this.endShape()}else for(let r=0;r<=t;++r){const i=e*(2*r/t-1);this.line(i,-e,0,i,+e,0),this.line(-e,i,0,e,i,0)}this.pop(this._rendererState)},p5.prototype.cross=function(...e){this._renderer.cross(...e)},p5.RendererGL.prototype.cross=function({mMatrix:e=this.mMatrix(),x:t,y:r,size:i=50,eMatrix:o,pMatrix:n,vMatrix:s,pvMatrix:a}={}){if(!t||!r){let p=this.parsePosition({from:e,to:Tree.SCREEN,pMatrix:n,vMatrix:s,pvMatrix:a});t=p.x,r=p.y,i/=this.pixelRatio(this.parsePosition({from:e,to:Tree.WORLD,eMatrix:o}))}const p=i/2;this._rendererState=this.push(),this.beginHUD(),this.line(t-p,r,t+p,r),this.line(t,r-p,t,r+p),this.endHUD(),this.pop(this._rendererState)},p5.prototype.bullsEye=function(...e){this._renderer.bullsEye(...e)},p5.RendererGL.prototype.bullsEye=function({mMatrix:e=this.mMatrix(),x:t,y:r,size:i=50,shape:o=Tree.CIRCLE,eMatrix:n,pMatrix:s,vMatrix:a,pvMatrix:p}={}){if(!t||!r){let o=this.parsePosition({from:e,to:Tree.SCREEN,pMatrix:s,vMatrix:a,pvMatrix:p});t=o.x,r=o.y,i/=this.pixelRatio(this.parsePosition({from:e,to:Tree.WORLD,eMatrix:n}))}if(this._rendererState=this.push(),o===Tree.CIRCLE)this.beginHUD(),this._circle({x:t,y:r,radius:i/2}),this.endHUD();else{const e=i/2;this.beginHUD(),this.line(t-e,r-e+.6*e,t-e,r-e),this.line(t-e,r-e,t-e+.6*e,r-e),this.line(t+e-.6*e,r-e,t+e,r-e),this.line(t+e,r-e,t+e,r-e+.6*e),this.line(t+e,r+e-.6*e,t+e,r+e),this.line(t+e,r+e,t+e-.6*e,r+e),this.line(t-e+.6*e,r+e,t-e,r+e),this.line(t-e,r+e,t-e,r+e-.6*e),this.endHUD()}this.cross({x:t,y:r,size:.6*i}),this.pop(this._rendererState)},p5.prototype._circle=function(...e){this._renderer._circle(...e)},p5.RendererGL.prototype._circle=function({filled:e=!1,x:t=this.width/2,y:r=this.height/2,radius:i=100,detail:o=50}={}){if(this._rendererState=this.push(),e){this.beginShape(p5.prototype.TRIANGLE_STRIP);for(let e=0;e<=o;e++){const t=Math.cos(e*(2*Math.PI)/o),r=Math.sin(e*(2*Math.PI)/o);this.vertex(0,0,0,.5,.5),this.vertex(i*t,i*r,0,.5*t+.5,.5*r+.5)}this.endShape()}else{this.translate(t,r);const e=2*Math.PI/o;let n={x:i,y:0};for(let t=1;t<=o;t++){const r={x:Math.cos(t*e)*i,y:Math.sin(t*e)*i};this.line(n.x,n.y,r.x,r.y),n=r}}this.pop(this._rendererState)},p5.prototype.viewFrustum=function(...e){this._renderer.viewFrustum(...e)},p5.RendererGL.prototype.viewFrustum=function({vMatrix:e=this.vMatrix(),pg:t,eMatrix:r=t?.eMatrix(),pMatrix:i=t?.pMatrix(),bits:o=Tree.NEAR|Tree.FAR,viewer:n=(()=>this.axes({size:50,bits:Tree.X|Tree._X|Tree.Y|Tree._Y|Tree.Z|Tree._Z}))}={}){if(this===t)return void console.error("displaying viewFrustum requires a pg different than this");if(!i||!r)return void console.error("displaying viewFrustum requires either a pg or projection and eye matrices");this._rendererState=this.push(),this.uModelMatrix=new p5.Matrix,this.uViewMatrix=new p5.Matrix,this.applyMatrix(...e.mat4),this.applyMatrix(...r.mat4),n!==Tree.NONE&&n();const s=i.isOrtho(),a=!s&&0!=(o&Tree.APEX),p=-i.nPlane(),h=-i.fPlane(),c=i.lPlane(),l=i.rPlane(),u=i.isOrtho()?-i.tPlane():i.tPlane(),f=i.isOrtho()?-i.bPlane():i.bPlane(),d=s?1:h/p,x=d*c,m=d*l,M=d*f,y=d*u;0!=(o&Tree.FAR)?(this.beginShape(),this.vertex(x,y,h),this.vertex(m,y,h),this.vertex(m,M,h),this.vertex(x,M,h),this.endShape(p5.prototype.CLOSE)):(this.line(x,y,h,m,y,h),this.line(m,y,h,m,M,h),this.line(m,M,h,x,M,h),this.line(x,M,h,x,y,h)),0!=(o&Tree.BODY)?(this.beginShape(),this.vertex(x,y,h),this.vertex(c,u,p),this.vertex(l,u,p),this.vertex(m,y,h),this.endShape(),this.beginShape(),this.vertex(m,y,h),this.vertex(l,u,p),this.vertex(l,f,p),this.vertex(m,M,h),this.endShape(),this.beginShape(),this.vertex(m,M,h),this.vertex(l,f,p),this.vertex(c,f,p),this.vertex(x,M,h),this.endShape(),this.beginShape(),this.vertex(c,u,p),this.vertex(x,y,h),this.vertex(x,M,h),this.vertex(c,f,p),this.endShape(),a&&(this.line(0,0,0,l,u,p),this.line(0,0,0,c,u,p),this.line(0,0,0,c,f,p),this.line(0,0,0,l,f,p))):(this.line(a?0:l,a?0:u,a?0:p,m,y,h),this.line(a?0:c,a?0:u,a?0:p,x,y,h),this.line(a?0:c,a?0:f,a?0:p,x,M,h),this.line(a?0:l,a?0:f,a?0:p,m,M,h)),0!=(o&Tree.NEAR)?(this.beginShape(),this.vertex(c,u,p),this.vertex(l,u,p),this.vertex(l,f,p),this.vertex(c,f,p),this.endShape(p5.prototype.CLOSE)):(this.line(c,u,p,l,u,p),this.line(l,u,p,l,f,p),this.line(l,f,p,c,f,p),this.line(c,f,p,c,u,p)),this.pop(this._rendererState)};
//# sourceMappingURL=/sm/96aefe4a89703bef15f95659055dc7d23025664e45a5577a792c33977143f7c3.map